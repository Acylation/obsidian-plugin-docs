"use strict";(self.webpackChunkobsidian_plugin_docs=self.webpackChunkobsidian_plugin_docs||[]).push([[2385],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,g=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return n?i.createElement(g,a(a({ref:t},c),{},{components:n})):i.createElement(g,a({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var p=2;p<o;p++)a[p]=n[p];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},41856:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var i=n(83117),r=(n(67294),n(3905));const o={sidebar_position:10},a="View plugins",s={unversionedId:"concepts/editor-extensions/view-plugins",id:"concepts/editor-extensions/view-plugins",title:"View plugins",description:"A view plugin is an editor extension that gives you access to the editor viewport.",source:"@site/docs/concepts/editor-extensions/view-plugins.md",sourceDirName:"concepts/editor-extensions",slug:"/concepts/editor-extensions/view-plugins",permalink:"/obsidian-plugin-docs/concepts/editor-extensions/view-plugins",draft:!1,editUrl:"https://github.com/marcusolsson/obsidian-plugin-docs/edit/main/docs/concepts/editor-extensions/view-plugins.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"docs",previous:{title:"Viewport",permalink:"/obsidian-plugin-docs/concepts/editor-extensions/viewport"},next:{title:"Communicating with editor extensions",permalink:"/obsidian-plugin-docs/concepts/editor-extensions/communicating-with-editor-extensions"}},l={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Creating a view plugin",id:"creating-a-view-plugin",level:2}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"view-plugins"},"View plugins"),(0,r.kt)("p",null,"A view plugin is an ",(0,r.kt)("a",{parentName:"p",href:"/obsidian-plugin-docs/concepts/editor-extensions/"},"editor extension")," that gives you access to the editor ",(0,r.kt)("a",{parentName:"p",href:"/obsidian-plugin-docs/concepts/editor-extensions/viewport"},"viewport"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This page aims to distill the official CodeMirror 6 documentation for Obsidian plugin developers. For more information on state management, refer to ",(0,r.kt)("a",{parentName:"p",href:"https://codemirror.net/docs/guide/#affecting-the-view"},"Affecting the View"),".")),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Basic understanding of the ",(0,r.kt)("a",{parentName:"li",href:"/obsidian-plugin-docs/concepts/editor-extensions/viewport"},"Viewport"),".")),(0,r.kt)("h2",{id:"creating-a-view-plugin"},"Creating a view plugin"),(0,r.kt)("p",null,"View plugins are editor extensions that run ",(0,r.kt)("em",{parentName:"p"},"after")," the viewport has been recomputed. While this means that they can access the viewport, it also means that a view plugin can't make any changes that would impact the viewport. For example, by inserting blocks or line breaks into the document."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you want to make changes that impact the vertical layout of the editor, by for example inserting blocks and line breaks, you need to use a ",(0,r.kt)("a",{parentName:"p",href:"/obsidian-plugin-docs/concepts/editor-extensions/state-fields"},"state field"),".")),(0,r.kt)("p",null,"To create a view plugin, create a class that implements ",(0,r.kt)("a",{parentName:"p",href:"https://codemirror.net/docs/ref/#view.PluginValue"},"PluginValue")," and pass it to the ",(0,r.kt)("a",{parentName:"p",href:"https://codemirror.net/docs/ref/#view.ViewPlugin%5EfromClass"},"ViewPlugin.fromClass()")," function."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="plugin.ts"',title:'"plugin.ts"'},'import {\n  ViewUpdate,\n  PluginValue,\n  EditorView,\n  ViewPlugin,\n} from "@codemirror/view";\n\nclass ExamplePlugin implements PluginValue {\n  constructor(view: EditorView) {\n    // ...\n  }\n\n  update(update: ViewUpdate) {\n    // ...\n  }\n\n  destroy() {\n    // ...\n  }\n}\n\nexport const examplePlugin = ViewPlugin.fromClass(ExamplePlugin);\n')),(0,r.kt)("p",null,"The three methods of the view plugin control its lifecycle:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"constructor()")," initializes the plugin."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"update()")," updates your plugin when something has changed, for example when the user entered or selected some text."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"destroy()")," cleans up after the plugin.")),(0,r.kt)("p",null,"While the view plugin in the example works, it doesn't do much. If you want to better understand what causes the plugin to update, you can add a ",(0,r.kt)("inlineCode",{parentName:"p"},"console.log(update);")," line to the ",(0,r.kt)("inlineCode",{parentName:"p"},"update()")," method to print all updates to the console."))}u.isMDXComponent=!0}}]);